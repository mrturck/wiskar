<!DOCTYPE html>
<html>
  <head>
    <title>Mouse Click Example - A-Frame</title>
    <meta name="description" content="Mouse Click Example - A-Frame">
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>

    <!--
    The event-set component gives you a quick way to add events
    to elements (like click, mouseenter, mouseleave, mousedown, mouseup, and fusing)
    without having to write Javascript for each event.

    For exmample if you want to give the user feedback when they hover over the element,
    you can do event-set__enter="_event: mouseenter; material.color: blue"
    -->
    <script src="https://unpkg.com/aframe-event-set-component@^4.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v3.13.1/dist/aframe-extras.min.js"></script>

  </head>
  <body>
    <a-scene keyboard-shortcuts="" screenshot="" vr-mode-ui="">
      <!--
           The camera has a cursor component,
           which uses the mouse as the rayOrigin,
           so that you can click entities in the scene
           with the mouse.
      -->
      <a-entity id="camera" camera="userHeight: 1.6" look-controls wasd-controls cursor="rayOrigin: mouse"></a-entity>

      <a-box position="-1 0.5 -3" rotation="0 0 0" color="#4CC3D9" shadow>
             <!-- event-set__enter="_event: mouseenter; color: #026fc9"
             event-set__leave="_event: mouseleave; color: #4CC3D9"> -->
        <!-- This animation begins when the box is clicked with the mouse. -->

      </a-box>

      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E" shadow>
                <!-- event-set__enter="_event: mouseenter; color: #026fc9"
                event-set__leave="_event: mouseleave; color: #EF2D5E"> -->

        <!-- This animation begins when the sphere is clicked with the mouse. -->
        <a-animation attribute="position"
               dur="1000"
               fill="forwards"
               to="0 2.5 -6"
               direction="alternate"
               begin="click"></a-animation>
      </a-sphere>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4" shadow></a-plane>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene>
  </body>
</html>

<script>
var point;
var scene = document.querySelector('a-scene')

// set initial box listener
box = document.querySelector("a-box")
box.addEventListener('mouseup', function (evt) {
  point = evt.detail.intersection.point;
  createBox(point);
});

//function to create new boxes on click

  function createBox(point) {
    el = document.createElement("a-box");
    scene.appendChild(el);
    el.setAttribute('position',point)
    el.setAttribute('color',getRandomColor());
    el.addEventListener('mousedown', function (evt) {
        point = evt.detail.intersection.point;
        console.log(evt.detail.intersection.face.normal);
        // console.log(evt.detail.intersection.object);
        // console.log(point)
        createBox(point);
      })
  }

  function getRandomColor() {
  var letters = '0123456789ABCDEF';
  var color = '#';
  for (var i = 0; i < 6; i++) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}
</script>
